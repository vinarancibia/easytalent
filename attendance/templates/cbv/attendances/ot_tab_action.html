{% load i18n %}
{% load static %}
{% load basefilters %}

{% if perms.instance.change_attendance and perms.instance.delete_attendance or request.user|is_reportingmanager %}
    <a
        class="oh-btn oh-btn-group oh-btn--info"
        hx-get="{% url 'attendance-update' instance.id %}"
        hx-target="#genericModalBody"
        hx-swap='innerHTML'
        data-toggle='oh-modal-toggle'
        data-target="#genericModal"
        style="width: 50%;"
    >
        <button style="background: none; color: inherit; border: none; padding: 0; font: inherit; cursor: pointer; outline: inherit;">
            <ion-icon name="create-outline" role="img" class="md hydrated" aria-label="create outline"></ion-icon>{% trans "Edit" %}
        </button>
    </a>

    {% if instance.attendance_overtime_approve %}
    <a type="submit" href="#" title="{% trans 'Approved' %}" class="oh-btn oh-btn-group oh-btn--success oh-btn--disabled" onclick="event.stopPropagation()" style="width: 50%;">
        <button style="background: none; color: inherit; border: none; padding: 0; font: inherit; cursor: pointer; outline: inherit;">
            <ion-icon class="me-1" name="checkmark-done-outline"></ion-icon>{% trans "Approve" %}
        </button>
    </a>
    {% elif minot <= instance.overtime_second %}
            {% if instance.employee_id == request.user.employee_get and not request.user.is_superuser %}
                <a type="submit" href="#" class="oh-btn oh-btn--success w-50 oh-btn--disabled">
                    <ion-icon name="checkmark-done-outline"></ion-icon>
                    {% trans "Approve" %}
                </a>
            {% else %}
                <a type="submit" href="{% url 'approve-overtime' instance.id %}"
                    title="{% trans 'Approve Overtime' %}"
                    class="oh-btn oh-btn-group oh-btn--success w-50"
                    onclick="event.stopPropagation()"
                    >
                    <button style="background: none; color: inherit; border: none; padding: 0; font: inherit; cursor: pointer; outline: inherit;">
                        <ion-icon class="me-1" name="checkmark-done-outline"></ion-icon>{% trans "Approve" %}
                    </button>
                </a>
            {% endif %}
        {% elif instance.overtime_second >= 60 %}
        <a type="submit" href="#" title="{% trans 'Approve Overtime (OT < min.OT)' %}"
            class="oh-btn oh-btn-group oh-btn--warning w-50"
            onclick="event.stopPropagation();
            Swal.fire({
                  title: '{% trans 'Are you sure?' %}',
                  text: '{% trans 'This does not satisfy the minimum OT requirement!' %}',
                  icon: 'warning',
                  showCancelButton: true,
                  confirmButtonColor: '#3085d6',
                  cancelButtonColor: '#d33',
                  confirmButtonText: 'Approve',
                  cancelButtonText: 'Cancel'
                }).then((result) => {
                  if (result.isConfirmed) {
                    // Your approve action logic here
                    Swal.fire(
                      '{% trans 'Approved!' %}',
                      '{% trans 'Your action has been approved.' %}',
                      'success'
                    );
                    $('[data-ot-approve-id={{instance.id}}]').click();
                  }
                });                                        "
          >
          <button style="background: none; color: inherit; border: none; padding: 0; font: inherit; cursor: pointer; outline: inherit;">
            <ion-icon class="me-1" name="checkmark-done-outline"></ion-icon>{% trans "Approve" %}
        </button>
        </a>
        <button type="submit" data-ot-approve-id={{instance.id}} hidden href=""
            onclick="window.location.href='{% url 'approve-overtime' instance.id %}'"
            title="{% trans 'Approve Overtime' %}"
            class="oh-btn oh-btn--success w-100"
            >
            <ion-icon class="me-1" name="checkmark-done-outline"></ion-icon>
        </button>
    {% endif %}

    {% comment %} {% if instance.attendance_overtime_approve %}
        <a type="submit" href="#" title="{% trans 'Approved' %}" class="oh-btn oh-btn-group oh-btn--success oh-btn--disabled" onclick="event.stopPropagation()" style="width: 50%;">
            <button style="background: none; color: inherit; border: none; padding: 0; font: inherit; cursor: pointer; outline: inherit;">
                <ion-icon class="me-1" name="ban-outline"></ion-icon>{% trans "Approve" %}
            </button>
        </a>
    {% else %}
        <a type="submit" href="{% url 'approve-overtime' instance.id %}" title="{% trans 'Approve Overtime' %}" class="oh-btn oh-btn-group oh-btn--success" onclick="event.stopPropagation()" style="width: 50%;">
            <button style="background: none; color: inherit; border: none; padding: 0; font: inherit; cursor: pointer; outline: inherit;">
                <ion-icon class="me-1" name="checkmark-done-outline"></ion-icon>{% trans "Approve" %}
            </button>
        </a>
    {% endif %} {% endcomment %}

    <form action="{% url 'attendance-delete' instance.id  %}" onsubmit="return confirm('{% trans "Are you sure want to delete this attendance?" %}')" hx-target="#tab_contents" method='post' style="width: 50%;" class="oh-btn oh-btn-group oh-btn--danger">
        {% csrf_token %}
        <button type="submit" style="background: none; color: inherit; border: none; padding: 0; font: inherit; cursor: pointer; outline: inherit;">
            <ion-icon name="trash-outline"></ion-icon>{% trans 'Delete' %}
        </button>
    </form>
{% endif %}
